import{r as b,c as R,o as j,a as u,b as i,d as l,w as M,g as C,v as S,u as t,i as w,F as h,e as k,t as f,_,f as $,j as V,l as L,k as B}from"./app-B4bawft_.js";import{a as E}from"./adminToolService-CJMjH4Bo.js";function D(){const x=b([]),o=b(""),n=b(!1),m=b(""),r=b(""),v=b(""),c=[{label:"Enable Module",command:"enable"},{label:"Disable Module",command:"disable"},{label:"Migrate Module",command:"migrate"},{label:"Seed Module",command:"seed"}],p=R(()=>{const s=String(o.value).toLowerCase();return s.includes("error")||s.includes("exception")?"bg-mulberry-purple text-torch-red":"bg-badge-active text-color-active"}),g=async()=>{var s,d;n.value=!0;try{const{data:a}=await E.adminListModules();x.value=a.data}catch(a){o.value=`Error: ${((d=(s=a.response)==null?void 0:s.data)==null?void 0:d.error)||a.message}`}finally{n.value=!1}};return{modules:x,result:o,isLoading:n,moduleName:m,preClass:p,selectedModule:r,selectedCommand:v,moduleCommands:c,fetchModules:g,executeCommand:async()=>{var s,d,a;if(!(!v.value||!r.value)){n.value=!0;try{const{data:e}=await E.adminRunModuleCommand({command:v.value,module:r.value.name});o.value=e.message+`
`+(((s=e.output)==null?void 0:s.join(`
`))||""),await g()}catch(e){o.value=`Error: ${((a=(d=e.response)==null?void 0:d.data)==null?void 0:a.error)||e.message}`}finally{n.value=!1}}},createModule:async()=>{var s,d,a;if(m.value){n.value=!0;try{const{data:e}=await E.adminInstallModule({name:m.value});o.value=e.message+`
`+(((s=e.output)==null?void 0:s.join(`
`))||""),m.value="",await g()}catch(e){o.value=`Error: ${((a=(d=e.response)==null?void 0:d.data)==null?void 0:a.error)||e.message}`}finally{n.value=!1}}}}}const T={class:"space-y-4"},U={class:"grid grid-cols-12 gap-2"},F={class:"col-span-4"},z=["value"],I=["value"],q={class:"bg-background-body p-3 rounded-md"},A={class:"col-span-8"},G={class:"bg-background-body p-3 rounded-md h-[400px]"},K={__name:"ModuleManager",setup(x){const{modules:o,result:n,isLoading:m,moduleName:r,preClass:v,selectedModule:c,selectedCommand:p,moduleCommands:g,fetchModules:y,executeCommand:N,createModule:s}=D();return j(async()=>{await y()}),(d,a)=>(i(),u("div",T,[l("div",U,[l("div",F,[a[5]||(a[5]=l("h3",{class:"text-lg mb-2"},"Execute Command",-1)),M(l("select",{"onUpdate:modelValue":a[0]||(a[0]=e=>w(c)?c.value=e:null),class:"p-2 border rounded-md w-full mb-2"},[a[3]||(a[3]=l("option",{disabled:"",value:""},"Select Module",-1)),(i(!0),u(h,null,k(t(o),e=>(i(),u("option",{key:e,value:e},f(e.name),9,z))),128))],512),[[S,t(c)]]),M(l("select",{"onUpdate:modelValue":a[1]||(a[1]=e=>w(p)?p.value=e:null),class:"p-2 border rounded-md w-full mb-2"},[a[4]||(a[4]=l("option",{disabled:"",value:""},"Select Command",-1)),(i(!0),u(h,null,k(t(g),e=>(i(),u("option",{key:e.command,value:e.command},f(e.label),9,I))),128))],512),[[S,t(p)]]),C(_,{onClick:t(N),text:"Run Command",btnClass:"bg-indigo-night text-amethyst-purple rounded-md hover:bg-royal-purple mt-2 w-full",disabled:t(m)||!t(c)||!t(p)},null,8,["onClick","disabled"]),a[6]||(a[6]=l("h3",{class:"text-lg my-2"},"Create New Module",-1)),M(l("input",{"onUpdate:modelValue":a[2]||(a[2]=e=>w(r)?r.value=e:null),type:"text",class:"p-2 border rounded-md w-full mb-2",placeholder:"Module Name"},null,512),[[$,t(r)]]),C(_,{onClick:t(s),text:"Create Module",btnClass:"bg-indigo-night text-amethyst-purple rounded-md hover:bg-royal-purple mt-2 w-full",disabled:t(m)||!t(r)},null,8,["onClick","disabled"]),a[7]||(a[7]=l("h3",{class:"text-lg my-2"},[l("i",{class:"ti-package mr-2"}),V("Modules List")],-1)),l("ul",q,[(i(!0),u(h,null,k(t(o),e=>(i(),u("li",{key:e.name,class:"p-2 border-b border-border-line flex justify-between"},[l("span",null,f(e.name),1),l("span",{class:L(e.status==="Enabled"?"text-color-active":"text-torch-red")},f(e.status),3)]))),128))]),C(_,{onClick:t(y),text:"Refresh Modules",btnClass:"bg-indigo-night text-amethyst-purple rounded-md hover:bg-royal-purple mt-2 w-full"},null,8,["onClick"])]),l("div",A,[l("div",G,[a[8]||(a[8]=l("h3",{class:"mb-2 text-button-warning-text font-medium flex items-center gap-2 p-2"},[l("i",{class:"ti-clipboard"}),V(" Execution Result: ")],-1)),t(n)?(i(),u("pre",{key:0,class:L([t(v),"whitespace-pre-wrap text-sm p-2 rounded-md"])},f(t(n)),3)):B("",!0)])])])]))}};export{K as default};
